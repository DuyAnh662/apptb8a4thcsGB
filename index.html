<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#f5f7fa">

    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <title>B·∫£ng Th√¥ng B√°o 8A4</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.3/dist/umd/supabase.min.js"></script>
    <script src="config.js"></script>
    <script>
        window.supabase = window.supabase.createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_KEY);

        // üîî NOTIFICATION SETUP:
        // - Service Worker s·∫Ω t·ª± ƒë·ªông ƒëƒÉng k√Ω (script.js)
        // - Notification permission s·∫Ω ƒë∆∞·ª£c y√™u c·∫ßu khi load (setupNotifications in script.js)
        // - Supabase realtime s·∫Ω subscribe b·∫£ng "notification"
        // Xem README.md & NOTIFICATION_SETUP.md ƒë·ªÉ h∆∞·ªõng d·∫´n chi ti·∫øt
    </script>
</head>

<body class="theme-blue">

    <div id="loading-screen">
        <div class="spinner"></div>
        <div class="loading-text" style="margin-top: 10px; font-size: 12px; opacity: 0.7;">ƒêang kh·ªüi ƒë·ªông h·ªá th·ªëng...
        </div>
    </div>

    <canvas id="sky"></canvas>
    <div id="fireworks-container"></div>
    <div id="particles-js"></div>
    <main class="app-container" id="appWindow">
        <header class="window-header">
            <div class="header-title">B·∫£ng th√¥ng tin</div>
            <div class="header-actions">
                <button id="btn-theme-toggle" class="icon-btn" type="button" aria-label="Chuy·ªÉn ƒë·ªïi s√°ng/t·ªëi"><i
                        class="fas fa-moon"></i></button>
            </div>
        </header>

        <nav class="tab-navigation">
            <div class="tab-indicator"></div>
            <div class="tab-item active" data-tab="btvn"><i class="fas fa-book-open"></i> BTVN</div>
            <div class="tab-item" data-tab="tkb"><i class="fas fa-calendar-day"></i> TKB</div>
            <div class="tab-item" data-tab="updates"><i class="fas fa-bullhorn"></i> Tin t·ª©c</div>
            <div class="tab-item" data-tab="notifications"><i class="fas fa-bell"></i> Th√¥ng b√°o</div>
        </nav>

        <div class="content-area">
            <div id="panel-btvn" class="tab-panel active">
                <div class="panel-scroll" id="container-btvn"></div>
            </div>

            <div id="panel-tkb" class="tab-panel">
                <div class="panel-scroll">
                    <div id="container-tkb-today"></div>
                    <button class="btn-primary full-width mt-3" id="btn-full-week">
                        <i class="fas fa-expand-alt"></i> Xem c·∫£ tu·∫ßn
                    </button>
                </div>
            </div>

            <div id="panel-updates" class="tab-panel">
                <div class="panel-scroll" id="container-updates"></div>
            </div>

            <div id="panel-notifications" class="tab-panel">
                <div class="panel-scroll">
                    <div style="padding: 15px;">
                        <h3 style="margin-bottom: 10px;"><i class="fas fa-history"></i> L·ªãch s·ª≠ th√¥ng b√°o</h3>
                        <div id="container-notifications" style="font-size: 14px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="dock-wrapper">
        <div class="glass-dock">
            <div class="dock-icon" data-action="refresh"><i class="fas fa-sync-alt"></i></div>
            <div class="separator"></div>
            <div class="dock-icon" data-action="settings"><i class="fas fa-cog"></i></div>
        </div>
    </div>

    <div class="modal-overlay" id="modal-tkb">
        <div class="modal-glass large">
            <div class="modal-header">
                <h3>Th·ªùi kh√≥a bi·ªÉu tu·∫ßn</h3>
                <button class="btn-close" data-close="modal-tkb"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body" id="content-full-week"></div>
        </div>
    </div>

    <div class="modal-overlay" id="modal-settings">
        <div class="modal-glass small">
            <div class="modal-header">
                <h3>C√†i ƒë·∫∑t</h3>
                <button class="btn-close" data-close="modal-settings"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="card" style="background:transparent; border:none; padding:0;">
                    <div class="setting-item" style="display:block; margin-bottom: 15px;">
                        <div class="setting-label" style="margin-bottom: 10px;">
                            <i class="fas fa-palette"></i> M√†u ch·ªß ƒë·∫°o
                        </div>
                        <div class="color-picker-container">
                            <div class="color-dot blue" data-color="blue"></div>
                            <div class="color-dot pink" data-color="pink"></div>
                            <div class="color-dot green" data-color="green"></div>
                            <div class="color-dot purple" data-color="purple"></div>
                        </div>
                    </div>
                    <hr style="border:0; border-top:1px solid var(--glass-border); margin-bottom:15px;">

                    <div class="setting-item">
                        <div class="setting-label"><i class="fas fa-moon"></i> Ch·∫ø ƒë·ªô t·ªëi</div>
                        <label class="switch"><input type="checkbox" id="switch-darkmode"><span
                                class="slider"></span></label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <i class="fas fa-water"></i>Hi·ªáu ·ª©ng t·ªët h∆°n
                            <div style="font-size:10px; color:var(--text-sec); font-weight:400; margin-left:5px;">(M·ªù
                                k√≠nh, 3D, Particles)</div>
                        </div>
                        <label class="switch"><input type="checkbox" id="switch-liquid" checked><span
                                class="slider"></span></label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label"><i class="fas fa-sync"></i> T·ª± ƒë·ªông l√†m m·ªõi</div>
                        <label class="switch"><input type="checkbox" id="switch-autorefresh"><span
                                class="slider"></span></label>
                    </div>

                    <hr style="border:0; border-top:1px solid var(--glass-border); margin: 15px 0;">

                </div>
                <div style="text-align:center; margin-top:20px; font-size:11px; color:var(--text-sec);">Liquid OS v4.0 ‚Ä¢
                    Final Stable</div>
            </div>
        </div>
    </div>

    <div class="event-popup" id="eventPopup">
        <div class="event-popup-card">
            <button class="close" id="eventPopupClose"><i class="fas fa-times"></i></button>
            <h3 id="eventPopupTitle">Title</h3>
            <div id="eventPopupContent">Content</div>
        </div>
    </div>
    <div id="popup-selector" class="popup-overlay">
        <div class="selector-card">
            <div class="selector-header">
                <h3>C√†i ƒë·∫∑t ·ª®ng d·ª•ng</h3>
                <p>Ch·ªçn thi·∫øt b·ªã c·ªßa b·∫°n ƒë·ªÉ ti·∫øp t·ª•c</p>
                <button onclick="closeSelectorPopup()" class="btn-close-abs"><i class="fas fa-times"></i></button>
            </div>

            <div class="platform-options">
                <div class="platform-option android" onclick="handleAndroidClick()">
                    <div class="plat-icon"><i class="fab fa-android"></i></div>
                    <div class="plat-text">
                        <b>D√†nh cho Android v√† PC</b>
                        <span>C√†i ƒë·∫∑t tr·ª±c ti·∫øp (.apk/PWA)</span>
                    </div>
                </div>

                <div class="platform-option ios" onclick="handleIOSClick()">
                    <div class="plat-icon"><i class="fab fa-apple"></i></div>
                    <div class="plat-text">
                        <b>D√†nh cho iOS</b>
                        <span>C√†i ƒë·∫∑t Profile c·∫•u h√¨nh</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="popup-ios-guide" class="popup-overlay">
        <div class="guide-card ios-mode">
            <div class="guide-header">
                <div>
                    <h3>C√†i ƒë·∫∑t tr√™n iPhone / iPad</h3>
                    <div style="font-size:12px; color:var(--text-sec); margin-top:6px">H∆∞·ªõng d·∫´n t·ª´ng b∆∞·ªõc ƒë·ªÉ c√†i c·∫•u
                        h√¨nh (mobileconfig)</div>
                </div>
            </div>

            <div class="guide-body">
                <div class="ios-step">
                    <div class="step-icon"><i class="fas fa-cloud-download-alt"></i></div>
                    <div class="step-info">
                        <b>B∆∞·ªõc 1 ‚Äî T·∫£i h·ªì s∆°</b>
                        <p>Nh·∫•n n√∫t "T·∫£i H·ªì s∆°" b√™n d∆∞·ªõi. N·∫øu tr√¨nh duy·ªát h·ªèi, ch·ªçn <b>Cho ph√©p / Allow</b>.</p>
                    </div>
                </div>

                <div class="ios-step">
                    <div class="step-icon"><i class="fas fa-file-signature"></i></div>
                    <div class="step-info">
                        <b>B∆∞·ªõc 2 ‚Äî M·ªü C√†i ƒë·∫∑t</b>
                        <p>M·ªü <b>C√†i ƒë·∫∑t</b> ‚Üí v√†o ph·∫ßn <b>ƒê√£ t·∫£i v·ªÅ H·ªì s∆°</b> ho·∫∑c <b>General ‚Üí Profile</b> ƒë·ªÉ xem h·ªì
                            s∆° v·ª´a t·∫£i.</p>
                    </div>
                </div>

                <div class="ios-step">
                    <div class="step-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="step-info">
                        <b>B∆∞·ªõc 3 ‚Äî C√†i v√† X√°c nh·∫≠n</b>
                        <p>Ch·ªçn h·ªì s∆°, sau ƒë√≥ nh·∫•n <b>Install</b> v√† x√°c nh·∫≠n m√£ PIN n·∫øu ƒë∆∞·ª£c y√™u c·∫ßu. Sau khi c√†i xong,
                            quay l·∫°i ·ª©ng d·ª•ng.</p>
                    </div>
                </div>

                <a href="TB8A4.mobileconfig" download class="btn-primary full-width mt-3">
                    <i class="fab fa-apple"></i> T·∫£i H·ªì s∆° (Config)
                </a>

                <div style="display:flex; gap:10px; margin-top:12px;">
                    <button onclick="backToSelector()" class="btn-text-only">Quay l·∫°i ch·ªçn thi·∫øt b·ªã</button>
                    <button onclick="closeIOSPopup()" class="btn-primary" style="flex:1;">ƒê√£ hi·ªÉu, ƒë√≥ng</button>
                </div>
                <div id="particles-js"></div>
                <main class="app-container" id="appWindow">
                    <header class="window-header">
                        <div class="header-title">B·∫£ng th√¥ng tin</div>
                        <div class="header-actions">
                            <button id="btn-theme-toggle" class="icon-btn" type="button"
                                aria-label="Chuy·ªÉn ƒë·ªïi s√°ng/t·ªëi"><i class="fas fa-moon"></i></button>
                        </div>
                    </header>

                    <nav class="tab-navigation">
                        <div class="tab-indicator"></div>
                        <div class="tab-item active" data-tab="btvn"><i class="fas fa-book-open"></i> BTVN</div>
                        <div class="tab-item" data-tab="tkb"><i class="fas fa-calendar-day"></i> TKB</div>
                        <div class="tab-item" data-tab="updates"><i class="fas fa-bullhorn"></i> Tin t·ª©c</div>
                        <div class="tab-item" data-tab="notifications"><i class="fas fa-bell"></i> Th√¥ng b√°o</div>
                    </nav>

                    <div class="content-area">
                        <div id="panel-btvn" class="tab-panel active">
                            <div class="panel-scroll" id="container-btvn"></div>
                        </div>

                        <div id="panel-tkb" class="tab-panel">
                            <div class="panel-scroll">
                                <div id="container-tkb-today"></div>
                                <button class="btn-primary full-width mt-3" id="btn-full-week">
                                    <i class="fas fa-expand-alt"></i> Xem c·∫£ tu·∫ßn
                                </button>
                            </div>
                        </div>

                        <div id="panel-updates" class="tab-panel">
                            <div class="panel-scroll" id="container-updates"></div>
                        </div>

                        <div id="panel-notifications" class="tab-panel">
                            <div class="panel-scroll">
                                <div style="padding: 15px;">
                                    <h3 style="margin-bottom: 10px;"><i class="fas fa-history"></i> L·ªãch s·ª≠ th√¥ng b√°o
                                    </h3>
                                    <div id="container-notifications" style="font-size: 14px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>

                <div class="dock-wrapper">
                    <div class="glass-dock">
                        <div class="dock-icon" data-action="refresh"><i class="fas fa-sync-alt"></i></div>
                        <div class="separator"></div>
                        <div class="dock-icon" data-action="settings"><i class="fas fa-cog"></i></div>
                    </div>
                </div>

                <div class="modal-overlay" id="modal-tkb">
                    <div class="modal-glass large">
                        <div class="modal-header">
                            <h3>Th·ªùi kh√≥a bi·ªÉu tu·∫ßn</h3>
                            <button class="btn-close" data-close="modal-tkb"><i class="fas fa-times"></i></button>
                        </div>
                        <div class="modal-body" id="content-full-week"></div>
                    </div>
                </div>

                <div class="modal-overlay" id="modal-settings">
                    <div class="modal-glass small">
                        <div class="modal-header">
                            <h3>C√†i ƒë·∫∑t</h3>
                            <button class="btn-close" data-close="modal-settings"><i class="fas fa-times"></i></button>
                        </div>
                        <div class="modal-body">
                            <div class="card" style="background:transparent; border:none; padding:0;">
                                <div class="setting-item" style="display:block; margin-bottom: 15px;">
                                    <div class="setting-label" style="margin-bottom: 10px;">
                                        <i class="fas fa-palette"></i> M√†u ch·ªß ƒë·∫°o
                                    </div>
                                    <div class="color-picker-container">
                                        <div class="color-dot blue" data-color="blue"></div>
                                        <div class="color-dot pink" data-color="pink"></div>
                                        <div class="color-dot green" data-color="green"></div>
                                        <div class="color-dot purple" data-color="purple"></div>
                                    </div>
                                </div>
                                <hr style="border:0; border-top:1px solid var(--glass-border); margin-bottom:15px;">

                                <div class="setting-item">
                                    <div class="setting-label"><i class="fas fa-moon"></i> Ch·∫ø ƒë·ªô t·ªëi</div>
                                    <label class="switch"><input type="checkbox" id="switch-darkmode"><span
                                            class="slider"></span></label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <i class="fas fa-water"></i>Hi·ªáu ·ª©ng t·ªët h∆°n
                                        <div
                                            style="font-size:10px; color:var(--text-sec); font-weight:400; margin-left:5px;">
                                            (M·ªù
                                            k√≠nh, 3D, Particles)</div>
                                    </div>
                                    <label class="switch"><input type="checkbox" id="switch-liquid" checked><span
                                            class="slider"></span></label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label"><i class="fas fa-sync"></i> T·ª± ƒë·ªông l√†m m·ªõi</div>
                                    <label class="switch"><input type="checkbox" id="switch-autorefresh"><span
                                            class="slider"></span></label>
                                </div>

                                <hr style="border:0; border-top:1px solid var(--glass-border); margin: 15px 0;">

                            </div>
                            <div style="text-align:center; margin-top:20px; font-size:11px; color:var(--text-sec);">
                                Liquid OS v4.0 ‚Ä¢
                                Final Stable</div>
                        </div>
                    </div>
                </div>

                <div class="event-popup" id="eventPopup">
                    <div class="event-popup-card">
                        <button class="close" id="eventPopupClose"><i class="fas fa-times"></i></button>
                        <h3 id="eventPopupTitle">Title</h3>
                        <div id="eventPopupContent">Content</div>
                    </div>
                </div>
                <div id="popup-selector" class="popup-overlay">
                    <div class="selector-card">
                        <div class="selector-header">
                            <h3>C√†i ƒë·∫∑t ·ª®ng d·ª•ng</h3>
                            <p>Ch·ªçn thi·∫øt b·ªã c·ªßa b·∫°n ƒë·ªÉ ti·∫øp t·ª•c</p>
                            <button onclick="closeSelectorPopup()" class="btn-close-abs"><i
                                    class="fas fa-times"></i></button>
                        </div>

                        <div class="platform-options">
                            <div class="platform-option android" onclick="handleAndroidClick()">
                                <div class="plat-icon"><i class="fab fa-android"></i></div>
                                <div class="plat-text">
                                    <b>D√†nh cho Android v√† PC</b>
                                    <span>C√†i ƒë·∫∑t tr·ª±c ti·∫øp (.apk/PWA)</span>
                                </div>
                            </div>

                            <div class="platform-option ios" onclick="handleIOSClick()">
                                <div class="plat-icon"><i class="fab fa-apple"></i></div>
                                <div class="plat-text">
                                    <b>D√†nh cho iOS</b>
                                    <span>C√†i ƒë·∫∑t Profile c·∫•u h√¨nh</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="popup-ios-guide" class="popup-overlay">
                    <div class="guide-card ios-mode">
                        <div class="guide-header">
                            <div>
                                <h3>C√†i ƒë·∫∑t tr√™n iPhone / iPad</h3>
                                <div style="font-size:12px; color:var(--text-sec); margin-top:6px">H∆∞·ªõng d·∫´n t·ª´ng b∆∞·ªõc
                                    ƒë·ªÉ c√†i c·∫•u
                                    h√¨nh (mobileconfig)</div>
                            </div>
                        </div>

                        <div class="guide-body">
                            <div class="ios-step">
                                <div class="step-icon"><i class="fas fa-cloud-download-alt"></i></div>
                                <div class="step-info">
                                    <b>B∆∞·ªõc 1 ‚Äî T·∫£i h·ªì s∆°</b>
                                    <p>Nh·∫•n n√∫t "T·∫£i H·ªì s∆°" b√™n d∆∞·ªõi. N·∫øu tr√¨nh duy·ªát h·ªèi, ch·ªçn <b>Cho ph√©p / Allow</b>.
                                    </p>
                                </div>
                            </div>

                            <div class="ios-step">
                                <div class="step-icon"><i class="fas fa-file-signature"></i></div>
                                <div class="step-info">
                                    <b>B∆∞·ªõc 2 ‚Äî M·ªü C√†i ƒë·∫∑t</b>
                                    <p>M·ªü <b>C√†i ƒë·∫∑t</b> ‚Üí v√†o ph·∫ßn <b>ƒê√£ t·∫£i v·ªÅ H·ªì s∆°</b> ho·∫∑c <b>General ‚Üí Profile</b>
                                        ƒë·ªÉ xem h·ªì
                                        s∆° v·ª´a t·∫£i.</p>
                                </div>
                            </div>

                            <div class="ios-step">
                                <div class="step-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="step-info">
                                    <b>B∆∞·ªõc 3 ‚Äî C√†i v√† X√°c nh·∫≠n</b>
                                    <p>Ch·ªçn h·ªì s∆°, sau ƒë√≥ nh·∫•n <b>Install</b> v√† x√°c nh·∫≠n m√£ PIN n·∫øu ƒë∆∞·ª£c y√™u c·∫ßu. Sau
                                        khi c√†i xong,
                                        quay l·∫°i ·ª©ng d·ª•ng.</p>
                                </div>
                            </div>

                            <a href="TB8A4.mobileconfig" download class="btn-primary full-width mt-3">
                                <i class="fab fa-apple"></i> T·∫£i H·ªì s∆° (Config)
                            </a>

                            <div style="display:flex; gap:10px; margin-top:12px;">
                                <button onclick="backToSelector()" class="btn-text-only">Quay l·∫°i ch·ªçn thi·∫øt b·ªã</button>
                                <button onclick="closeIOSPopup()" class="btn-primary" style="flex:1;">ƒê√£ hi·ªÉu,
                                    ƒë√≥ng</button>
                            </div>
                        </div>
                    </div>
                </div>
                <script src="script.js"></script>
                <script src="app-banner.js"></script>

</body>

</html>